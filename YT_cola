/* 
This bookmarklet opens a new window to play a YouTube video in an embedded player. 
If the window is already open, it adds the current video to the queue.

How to use:
1. Navigate to a YouTube video.
2. Click this bookmarklet to open the video in a new window or add it to the queue if the window is already open.

Este bookmarklet abre una nueva ventana para reproducir un vídeo de YouTube en un reproductor integrado. 
Si la ventana ya está abierta, agrega el video actual a la cola.
1. Navega hasta un vídeo de YouTube.
2. Haga clic en este marcador para abrir el video en una nueva ventana o agregarlo a la cola si la ventana ya está abierta.
*/

javascript:(function(){var videoId=window.location.search.split('v=')[1];if(videoId){var ampersandPosition=videoId.indexOf('&');if(ampersandPosition!=-1){videoId=videoId.substring(0,ampersandPosition);}var queueWindow=window.open('','Video Queue','width=800,height=600,scrollbars=no,toolbar=no,location=no,directories=no,status=no,menubar=no,resizable=yes,copyhistory=no');if(queueWindow.location.href==='about:blank'){queueWindow.document.open();queueWindow.document.write('<html><head><title>YT Cola by budz</title><style>body { margin: 0; }</style><script>var queue=["'+videoId+'"];var currentIndex=0;function loadVideo(){var iframe=document.getElementById("videoFrame");iframe.src="https://www.youtube.com/embed/"+queue[currentIndex]+"?autoplay=1&rel=0";}function nextVideo(){if(currentIndex<queue.length-1){currentIndex++;loadVideo();}}function addToQueue(videoId){queue.push(videoId);if(queue.length===1){loadVideo();}}window.onload=function(){loadVideo();window.addEventListener("message",function(event){if(event.data.action==="addToQueue"){addToQueue(event.data.videoId);}});}</script></head><body><iframe id="videoFrame" style="width:100%;height:100%;border:none;" allow="autoplay; fullscreen"></iframe><button onclick="nextVideo()" style="position:absolute;top:10px;right:10px;">Next</button></body></html>');queueWindow.document.close();}else{queueWindow.postMessage({action:'addToQueue',videoId:videoId},'*');}}else{alert('Not a valid YouTube video URL.');}})();
